The following query is performing poorly:
[Paste problematic query]

Execution plan:
[Paste execution plan if available]

Please analyze this query and suggest improvements:
1. Identify any sub-optimal parts of the query or execution plan
2. Suggest alternative ways to write the query
3. Are there any missing indexes that could help?
4. Would denormalizing any part of the schema improve performance for this query?