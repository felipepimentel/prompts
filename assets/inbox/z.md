I need to optimize the following SQL query:
[Paste your query here]

The query is currently taking too long to execute on large datasets. Please:
1. Analyze the query and identify potential performance issues.
2. Suggest optimizations, which may include:
   - Rewriting the query
   - Adding or modifying indexes
   - Suggestions for schema changes if necessary
3. Explain the reasoning behind each optimization.
4. If possible, provide an estimate of the performance improvement we might expect.
Additional context:
- Database system: [e.g., PostgreSQL, MySQL]
- Approximate table sizes: [e.g., Users table has 1 million rows]
- Any relevant hardware constraints